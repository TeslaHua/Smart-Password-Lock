C51 COMPILER V9.02   MAIN                                                                  12/19/2015 20:58:45 PAGE 1   


C51 COMPILER V9.02, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\main.obj
COMPILER INVOKED BY: E:\KEIL C51\C51\BIN\C51.EXE ..\MAIN\main.c BROWSE INCDIR(..\HEADER) DEBUG OBJECTEXTEND PRINT(.\main
                    -.lst) OBJECT(.\main.obj)

line level    source

   1          /*********************************************************************************************************
             -****
   2          빦ܣΪ֡û˵ûȨ޸ߣúң룬8λ룬0~9
             -Ч
   3                            û뿪Сʱ˸룬δʱ5s
             -
   4                            סû޷롣û󣬣ֻȷдȨޣ԰0x46
             -룬
   5                            빻8λʱ£EQٴȷ룬ͬóɹʧܡ
             -
   6                            û벻8λͰ£EQʱϵͳֱʾô󡣣ɹʧ̵ܶ
             -
   7                            ڵûʱ书ܣû£0x47ʱʾʾǰʱ䡣֧һܣû루0x
             -45ʱ
   8                            ϵͳԶ5sָԭʼ״̬ûȨԼ򵥣þ8λ룬11ʾ֮
             -
   9                            һλ룬һλ붼ûͰ´˼ϵͳʾûû룻12ʾɣû
             -
  10                            λͰ´˼ʱϵͳʾûλ
  11          
  12          ʱ䣺2015/11/19
  13          **********************************************************************************************************
             -*********/
  14          
  15          
  16          #include"Base.h"
  17          #include"LCD1602.h"
  18          #include"LedAndBuzzer.h"
  19          #include"Keyboard.h"
  20          #include"At24c02.h"
  21          #include"DS1302.h"
  22          
  23          uchar Compare_flag=0,finish_flag=0,AllowModify_flag=0; //Compare_flagǱ־ſԽбȽ
             -Ƿȷ;finish_flagÿʾı־CDIS1CDIS2;
  24                                                                 //AllowModify_flagҪ޸ʱı־λ(ֻ
             -޸)
  25          uchar Timer_flag=0;                                    //˱־λȷ󴥷Ķʱжϣ
             -0Сδжϣ2ֻ
  26                                                                 //ζжϣ1
  27          uchar First_flag=0;        //һı־
  28          uchar Second_flag=0;   //ڶı־
  29          
  30          uchar Value1[8]; //ԭʼ룺12345678ҪѴ˴أ
  31          //={0x0c,0x18,0x5e,0x08,0x1c,0x5a,0x42,0x52}
  32          uchar Value2[9];//ǰλûԱԭʼȽϣһλȷϰֵ
  33          uchar Value3[9];//ǰλû趨ʱ飬һλȷϰֵ
  34          
  35          uchar count=0;      //ŴĴ  
  36          uchar set_count=0;  //¼ʱռ洢ռĸ
  37          
  38          uchar code CDIS1[]={"PLEASE ENTER THE"};  //
  39          uchar code CDIS2[]={"CODE:  -------- "};
  40          uchar code CDIS3[]={"SORRY , AGAIN  !"};  //
  41          uchar code CDIS4[]={" CODE IS RIGHT !"};  //ȷ
C51 COMPILER V9.02   MAIN                                                                  12/19/2015 20:58:45 PAGE 2   

  42          uchar code CDIS5[]={" OPEN  SESAME. !"};
  43          
  44          uchar code CDIS10[]={"  PASSWORD SET  "};   //ʾûóɹ
  45          uchar code CDIS11[]={"  SUCCESSFULLY !"};
  46          uchar code CDIS12[]={"  PASSWORD SET  "};       //ʾûʧ
  47          uchar code CDIS13[]={"     FAILED    !"};  
  48               
  49          void Judge_RightOrWrong();          //жû
  50          void Init();                    //ȳʼ
  51          void Display(uchar CDIS1[],uchar CDIS2[]); //ʾLCD1602ϵľ
  52          
  53          /*
  54          
  55          ֵ
  56          
  57          */
  58          void main()
  59          {
  60   1              uchar i=0;
  61   1              Init();      //Լжϳʼ       
  62   1              lcdinit();   //1602ʼ
  63   1              Ds1302init();//DS1302ʼ
  64   1              Display(CDIS1,CDIS2); //LCD1602Ĺ̶ʾ
  65   1              //SerialInit();       //ڳʼ
  66   1              while(1)
  67   1              {               
  68   2                      Key_scan();
  69   2                      if(First_flag==1)         //˵һѾ趨
  70   2                      {
  71   3                              if(Second_flag==1)    //˵ڶѾ趨
  72   3                              {
  73   4                                      EX0=0;   //رⲿж0ֹ
  74   4                                      if(Value2[0]==Value3[0]&&Value2[1]==Value3[1]&&Value2[2]==Value3[2]&&Value2[3]==Value3[3]
  75   4                                              &&Value2[4]==Value3[4]&&Value2[5]==Value3[5]&&Value2[6]==Value3[6]&&Value2[7]==Value3[7]) //
             -бȽ
  76   4                                      {
  77   5                                              Display(CDIS10,CDIS11); //LCD1602Ĺ̶ʾ,ʾû趨ɹ
  78   5                                              //´ΪAT24C02ĳʼַΪ08ռڴûɹ޸֮µ8λ벢ǵԭ
  79   5      
  80   5                                              At24c02Write(0,Value2);
  81   5      
  82   5                                              //ϴΪAT24C02ĳʼַΪ08ռڴûɹ޸֮µ8λ벢ǵԭ
  83   5                                      }
  84   4                                      else
  85   4                                              Display(CDIS12,CDIS13); //LCD1602Ĺ̶ʾ,ʾû趨ʧ
  86   4      
  87   4                                      First_flag=0;
  88   4                                      Second_flag=0;  //ʾ붼Ѿɣ
  89   4      
  90   4                                      Timer_flag=0;  //Чһʾ
  91   4                                      BuzzerOpenOrClose(buzzer_on);
  92   4                                      TR0=1;
  93   4                              }                                       
  94   3                      }
  95   2                      Judge_RightOrWrong();        //жû           
  96   2              }
  97   1      }
  98          
  99          /*
 100          ʼʱ0жϺⲿж0
 101          ֵ
 102          
C51 COMPILER V9.02   MAIN                                                                  12/19/2015 20:58:45 PAGE 3   

 103          */                                                                       
 104          void Init()
 105          {
 106   1              //´ΪAT24C02ĳʼַΪ08ռڴ洢ԭʼ8λ루һسʱڶʱҪɾ
             -˶δ룩
 107   1      
 108   1              //At24c02Write(0,Value1);
 109   1      
 110   1              //ϴΪAT24C02ĳʼַΪ08ռڴ洢ԭʼ8λ루һسʱڶʱҪɾ
             -˶δ룩
 111   1      
 112   1          LightOrClose(green,led_off);    //ʼ̵
 113   1              LightOrClose(red,led_off);          //ʼú
 114   1              IT0=1; //½ش
 115   1              EX0=1; //ж0
 116   1              IRIN=1;//ʼ˿
 117   1      
 118   1              //ʱ0ҪǷӦķ
 119   1              TMOD=0X01;//ʱ0ѡʽ1
 120   1              TH0=0X0FA;  //ֵ64000.1536
 121   1              TL0=0X00;
 122   1              ET0=1;  //ʱ0ж
 123   1              
 124   1      
 125   1              EA=1;  //ж
 126   1      }
 127          
 128          /*
 129          жû󣬲Ӧķ
 130          ֵ
 131          
 132          */
 133          void Judge_RightOrWrong()
 134          {
 135   1              if(Compare_flag==1)  //ʾûɣԽбȽ
 136   1              {
 137   2                      Compare_flag=0;
 138   2                      //´ΪAT24C02ĳʼַΪ08ռڶȡ8λ벢Value1[]УûValue2[]
             -Ƚ
 139   2      
 140   2                      At24c02Read(0,Value1);
 141   2      
 142   2                      //´ΪAT24C02ĳʼַΪ08ռڶȡ8λ벢Value1[]УûValue2[]
             -Ƚ
 143   2                      if(Value1[0]==Value2[0]&&Value1[1]==Value2[1]&&Value1[2]==Value2[2]&&Value1[3]==Value2[3]
 144   2                              &&Value1[4]==Value2[4]&&Value1[5]==Value2[5]&&Value1[6]==Value2[6]&&Value1[7]==Value2[7]) //
             -
 145   2                      {
 146   3                              Display(CDIS4,CDIS5);//LCD1602Ĺ̶ʾ
 147   3                              LightOrClose(green,led_on);//ȷʱʾ̵
 148   3                              Timer_flag=0;        //ʾʱĶʱжǿųɹ
 149   3                              BuzzerOpenOrClose(buzzer_on);
 150   3                              AllowModify_flag=1;  //֮ʾ޸룬ѡMode
 151   3                              count=0;
 152   3                              EX0=0;      //رⲿж0޷
 153   3                              TR0=1;          //ʱ0
 154   3                      }
 155   2                      else            //һ
 156   2                      {
 157   3                              Display(CDIS3,CDIS2);  //LCD1602Ĺ̶ʾ
 158   3                              count++;               //Ĵ
 159   3                              if(count==3)           //
C51 COMPILER V9.02   MAIN                                                                  12/19/2015 20:58:45 PAGE 4   

 160   3                              {
 161   4                                      count=0;          //㣬Աһδʾ
 162   4                                      Timer_flag=1;     //3
 163   4                                      LightOrClose(red,led_on);//ȷʱʾ̵
 164   4                                      BuzzerOpenOrClose(buzzer_on);
 165   4                                      EX0=0;            //رⲿж0޷
 166   4                                      TR0=1;                //ʱ0
 167   4                              }
 168   3                              else
 169   3                              {  
 170   4                                  Timer_flag=2; //ûС3
 171   4                                  EX0=0;        //رⲿж0޷
 172   4                                  TR0=1;                //ʱ0
 173   4                              }                          
 174   3                      }
 175   2              }               
 176   1      }
 177          
 178          
 179          /*
 180          LCD1602ľʾ
 181          ֵ
 182            ʾ1602һŵĸCDIS1[];ʾ1602ڶŵĸCDIS2[]
 183          */
 184          void Display(uchar CDIS1[],uchar CDIS2[])
 185          {        
 186   1          uchar i;
 187   1              lcdwritecom(0x80);
 188   1              for(i=0;i<16;i++)
 189   1              {
 190   2                      lcdwritedate(CDIS1[i]);
 191   2              }       
 192   1              lcdwritecom(0x80+0x40);
 193   1              for(i=0;i<16;i++)
 194   1              {
 195   2                      lcdwritedate(CDIS2[i]); 
 196   2              }
 197   1      }
 198          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    433    ----
   CONSTANT SIZE    =    153    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     34       8
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
